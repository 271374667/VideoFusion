# Changelog

## [v1.12.5] - 2024-08-01

### Added
- 新增一个非常直观的gif demo让人10秒内了解该软件 (147ef46)。
- 新增一个全新的banner (147ef46)。

### Changed
- 完善了README的介绍，修改了徽章显示不了的问题 (7b49364)。
- 修改README内结构逻辑，为README添加徽章 (567d805)。
- 移动README里面的捐赠到文档当中，让README拥有更加一致的阅读体验 (4f78b76)。
- 修改文档里面github跳转为当前项目(之前是跳到个人仓库) (4e8bfed)。
- 优化了 README 以及文档 (ede6b91, bcbd0ce)。

### Fixed
- 修复了任务恢复系统在找不到本地文件的时候会报错的bug (147ef46)。
- 修复了不检测所有任务是否完成而直接检测总任务是否完成的bug (147ef46)。
- 修复了徽章版本不显示的bug (3392e88)。
- 通过固定窗体大小修复了在运行完毕之后窗口会“长高”的bug (14b8cc9)。
- 修复了开始一个空任务导致提示输入视频不能为空的bug (091a9d6)。
- 修复了文档内图片失效的问题以及README文字居中问题 (24fd63f)。

### Documentation
- 完善了文档内的重新开始的提示和文档的CHANGLOG (091a9d6)。
- 为README添加了徽章 (567d805)。
- 修复了README徽章显示不了的问题 (7b49364)。

### UI
- 现在第一次进入设置页面不会再弹出显示当前引擎的弹窗 (9398b4b)。

### Action
- 现在的action将仅使用手动触发 (091a9d6)。

## [v1.12.2] - 2024-07-31

这一次相比上一个 v0.32.4 版本增加了大量的新内容，整个底层的逻辑完全重写了，于是现在大版本号进化到了 v1，相比起之前这一次多了很多新的内容

1. 增加了一个新的处理引擎，使用功能更加强大的 OpenCV 引擎能够处理更加多样化的视频需求，同时也可以切换回 FFmpeg 引擎，以此来保证速度
2. 新增了备份系统，如果在合成的过程中报错了，程序会记住报错文件，下一次能直接处理失败的文件
3. 优化了 FFmpeg 引擎模式下除了 H264 编码器外的所有模式
4. 现在使用终止程序，程序会立即停下，并且马上释放资源
5. 优化了对没有音频的视频的处理，现在会自动加一个音频（以前会直接报错）
6. 完整的说明文档，您可以在仓库页面找到他们
7. 更多全新的处理器（OpenCV 模式下）
8. 界面细节进一步优化，更加符合操作直觉

### Added
- 主页删除视频时预览画面现在会实时刷新 (02f8c2b)。
- 显示了备份恢复，如果上一次任务没有完成将会自动恢复上一次的任务 (05d7d3a)。
- 完整实现了FFmpegEngine (640833d)。
- 现在的ffmpeg报错信息染色会更加全面 (640833d)。
- FFmpegEngine模式下使用了新的填充黑边的方式 (640833d)。
- 使用策略模式分离VideoEngine，现在OpenCV和FFmpeg都有自己的方法 (31ab275)。
- 设置页面的版本更新说明使用了新的messagebox提示框 (4513ed9)。
- 新增一个MessageBox可以使用一个无边框的信息弹框 (4513ed9)。
- 新增处理模式,未来可以选择使用什么引擎处理视频(ffmpeg,opencv) (7f3c11b)。
- 新增了文件树控件，为未来批量视频压缩功能做准备 (7f3c11b)。
- 现在会自动为没有音频轨道的视频添加音频 (82d0b20)。
- 现在软件的使用时间会在日志中输出 (af020ec)。
- 添加了一个真正的中断子线程的方法 (e3022a1)。
- 新增白平衡 (545e05c)。
- 新增亮度调整 (545e05c)。
- 新增视频AI平滑 (545e05c)。
- 新增了音频降噪处理器 (6c76102)。
- 新增一个线程超时自动杀死的函数 (896c94f)。
- 新增一个视频画面调整尺寸处理器 (896c94f)。
- 新增ESPCN视频超分AI模型以及处理器 (c49b4ef)。
- 新增LapSRN视频超分AI模型以及处理器 (c49b4ef)。
- 新增视频亮度和对比度调节处理器 (c49b4ef)。
- 新增白平衡处理器 (c34baae)。
- 新增了命令行调用方式 (e86d5c4)。
- 视频额外增加一层OpenCV处理层,未来能加入更多东西 (e86d5c4)。

### Changed
- 修改vitepress的base为VideoFusion (7d036c7)。
- 现在设置页面中仅OpenCV支持的功能被单独移动到了新的分组方便区分 (ec14943)。
- 现在设置页面的提示条消失的更快 (ec14943)。
- 重新修改视频降噪策略枚举类的值为ffmpeg的字符串 (640833d)。
- task_resumer新增一个获取输出路径的属性 (31ab275)。
- ffmpeg_handler中的一些私有方法现在转为公开方法 (31ab275)。
- video_handler的入参从task_resumer转换为更加通用的Path (31ab275)。
- 不再支持自动计算最大化音频采样率,以及移除相关依赖 (6c76102)。
- 修改了crop处理器的处理条件 (545e05c)。
- 修改了设置文件为设置文件夹，现在所有的视频都会输出到输出文件夹中 (bc92ba7)。

### Fixed
- 修复了H265格式下过于先进的参数会导致有一些老旧视频无法支持的bug(已经退回到更加兼容的参数) (99ad599)。
- 修复了少量静态视频在合并的时候长时间处于获取最佳分辨率的bug (02f8c2b)。
- 修复因为package.json不存在导致构建失败的bug (f2d284c)。
- 修复了H265格式编码导致的报错 (c5fb666)。
- 修复了在小部分情况下FFmpegEngine因为scale小于pad会报错的问题 (640833d)。
- 修复了设置页面修改临时目录等选项的时候ToolTip不会发生改变，而是需要重启才会发生改变的bug (7f3c11b)。
- 修复了多个视频合并的时候crop_processor剪裁会出现错误 (6696f8c)。
- 修复了获取视频信息时出现的一个逻辑漏洞 (6696f8c)。
- 修复了提取音频的时候出现多个输出结果的bug (6696f8c)。
- 修复了旋转角度为Nothing的时候会导致报错的bug (e3022a1)。
- 修复了横屏报错的bug (e3022a1)。
- 修复了processor_global_var可能全局不唯一的bug (e3022a1)。
- 修复了参数传入的时候会被清除导致没能正确设置的bug (e3022a1)。
- 修复了分析视频的时候主进度条不会发生改变的bug (e3022a1)。
- 修复了结束的时候没有正确的完成信号的bug (e3022a1)。
- 修复了即使不勾选删除临时文件夹也会导致文件夹被删除的bug (1e98c52)。
- 修复了退出后无法删除临时文件夹的bug (fdfb5a0)。
- 修复了video_info_reader模块中黑边逻辑的bug (bc92ba7)。

### Removed
- 删除vitepress的base (5c84fa7)。
- 删除了无用了函数 (733aeb2)。

### Documentation
- 更新了文档视频顺序调整的部分 (fcd1c39)。
- 调整了文档内导航栏的结构 (fcd1c39)。
- 添加了完整的 VideoFusion 的介绍 (42c5367)。

### Optimization
- 现在设置页面如果不是静态去黑边模式则视频采样率滑条会保存不可选状态 (42c5367)。
- 优化了报错页面的报错捕获条件 (c5fb666)。
- 优化了重新编译的参数，现在H265等其他编码器也有更好的效果 (d9dc12f)。
- 视频不需要合并的时候不会修改分辨率 (bc92ba7)。
- 将原本ffmpeg_handler中的compress_video中的职责分给reencode_video使其更加符合单一职责原则 (bc92ba7)。
- 优化了rotate_processor中获取值的方式，让其更加安全 (af020ec)。
- 重构了crop_processor中变量的访问权限 (af020ec)。
- 重构了TempDir在其他模块中的调用 (e3022a1)。
- 使用黑板模式代替DTO传递数据,更加灵活 (896c94f)。
- 使用ffmpeg_handler将所有需要用到ffmpeg的地方都整合到了这里 (896c94f)。
- 使用video_handler将所有对视频的操作整合到了这里 (896c94f)。
- 重构了剪裁处理器 (8cbdcb6)。
- 重构了旋转处理器 (8cbdcb6)。
- 使用OpenCV重构了去色带模块 (c34baae)。
- 使用OpenCV重构了去色块模块 (c34baae)。
- 使用OpenCV重构了去抖动模块 (c34baae)。
- 使用OpenCV重构了视频降噪模块 (c34baae)。
- 使用OpenCV重构了视频均值降噪模块模块 (c34baae)。
- 重构了获取视频信息的方式 (e86d5c4)。
- 重构了图片去黑边的方式,从中提取为单独的工具类,增加复用 (e86d5c4)。
- 重构两个去黑边方式,令他们面向对象 (e86d5c4)。

### Dependence
- 更新了nuitka和fluent-widget依赖 (4513ed9)。
- 重新依赖opencv-contrib-python (c34baae)。

### Actions
- 修改pnpm大版本号为9 (981ad52)。
- 试图让action能够识别pnpm-lock.yaml (0886911)。
- 修改pnpm的版本为9 (7ee8a1d)。
- 指定了pnpm的版本 (5666ff5)。
- 修改action中npm为pnpm (599feb7)。
- 新增了自动部署 vitepress 的 action (42c5367)。

### Tests
- 新增resize_processor的测试 (896c94f)。
- 为剪裁和旋转新增了测试 (8cbdcb6)。
- 新增了更多的测试 (c34baae)。
- 新增了测试4个测试 (e86d5c4)。

## [v0.32.4] - 2024-07-06

### Added
- 新增失败提示条，程序出错之后会在主页面弹出提示条进行提醒 (cdd175f)。
- 现在会检测ffprobe是否能够成功载入 (a6baa74)。

### Changed
- 更新了nuitka和fluent-widget相关依赖 (cc5b21c)。
- 更新了所有的依赖 (a6baa74)。

### Fixed
- 修复了自动去黑边因为视频剪裁宽高不一致而导致的小概率出现合成失败的bug (cdd175f)。
- 修复了ffprobe载入失败的bug (a6baa74)。

